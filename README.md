Данный кейс почти в неизменном виде давался в качестве тестового задания на позицию продуктового аналитика в компанию Самокат.

Описание данных
Таблица products:


product_id - id товара

level1 - категория

level2 - подкатегория

name - наименование товара

Таблица orders:


order_id - номер чека

accepted_at - дата и время чека

product_id - id товара

quantity - кол-во товара в чеке

regular_price   - регулярная цена

price   - текущая цена

cost_price - закупочная цена

Задания
Самая ходовая товарная группа
По какой категории товаров продано больше всего позиций?


Подкрепите свой ответ таблицей, в которой рассчитано количество проданных штук товара в каждой товарной категории.

Дополнительно постройте на основании этой таблицы barchart.

Проверьте, чтобы все подписи на вашем графике выглядели читаемо и понятно. Этот график должен быть сходу понятен стороннему наблюдателю.

Распределение продаж по подкатегориям
Оцените распределение количества проданных позиций в каждой товарной категории (level1) по подкатегориям (level2). Проиллюстрируйте свой результат расчетной таблицей.

Найти средний чек в заданную дату
Какой средний чек был 13.01.2022?

Доля промо в заданной категории
Когда товар продается по промо-акции, его базовая цена не совпадает с фактической ценой.

Вам необходимо:


Посчитать, какую долю от общих продаж категории Сыры занимают промо (в штуках)

Построить пайчарт, который это проиллюстрирует. На графике должны быть видны группы, соответствующие доли и понятные подписи к ним.

Посчитать маржу по категориям
Нужно посчитать маржу:


В рублях

В %

Сделать это нужно по всем категориям level1 и отобразить с помощью 2 горизонтальных барчартов. Все подписи должны быть читаемыми и понятными.

ABC анализ

Сделайте ABC-анализ продаж по количеству

Сделайте ABC-анализ по сумме продаж

Сделайте новый столбец, в котором будет итоговая группа на основании двух анализов. Например: A C.
